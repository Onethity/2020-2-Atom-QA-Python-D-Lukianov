# Скрипты для анализа логов Nginx

Скрипты на bash и python собирают следующую информацию о логах:
* Общее количество запросов
* Количество запросов по типу (GET, POST...)
* Топ 10 самых больших по размеру запросов
* Топ 10 запросов, которые завершились клиентской ошибкой
* Топ 10 запросов, которые завершились серверной ошибкой

## Инструкция
Оба скрипта имеют одинаковые параметры запуска вида:

`./analyze.py (<file>|<dir>...)`

`./analyze.sh (<file>|<dir>...)`

В качестве параметров необходимо передать путь к файлу с логами, либо папку с лог-файлами. Если передано несколько файлов, то статистика суммируется. 
Если передена папка, то из нее собираются все `*.log` файлы. Папки можно передавать в аргументы одновременно с файлами. Пример команды для запуска:

`./analyze.sh access.log /var/log/nginx`

Перед запуском необходимо дать скрипту права на исполнение: 

`chmod +x analyze.sh`

Для получения справки введите: `./analyze.sh -h`

После завершения работы скрипта результат сохранятеся в файл `output.txt` для bash скрипта и `output_py.txt` для python скрипта. Делиметером для файлов является последовательность символов `-------------------`.
Для python скрипта также реализована возможность сохранения данных в json формате в файл `output.json`.

Json файл имеет следующую структуру:
```json
{
    "Total requests": 2,
    "Requests types": [
        {
            "count": 2,
            "value": "GET"
        }
    ],
    "Biggest requests": [
        {
            "url": "/index.php",
            "size": "951"
        }
    ],
    "Client errors": [
        {
            "count": 1,
            "value": "/404.php 404 80.240.228.91"
        }
    ],
    "Server errors": [
        {
            "count": 1,
            "value": "/500.php 500 91.210.145.36"
        }
    ]
}
```
